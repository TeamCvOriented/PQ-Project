"""
æ¼”ç¤ºå¬ä¼—ç«¯ç­”é¢˜åŠŸèƒ½ä¿®å¤
"""
import webbrowser
import time
import subprocess
import sys
import os

def show_demo():
    """å±•ç¤ºä¿®å¤åçš„å¬ä¼—ç«¯åŠŸèƒ½"""
    print("=" * 60)
    print("ğŸ¯ å¬ä¼—ç«¯ç­”é¢˜åŠŸèƒ½ä¿®å¤æ¼”ç¤º")
    print("=" * 60)
    
    print("\nğŸ“‹ é—®é¢˜æè¿°:")
    print("1. å¬ä¼—ç‚¹å‡»'æäº¤ç­”æ¡ˆ'åå‡ºç°ç½‘ç»œé”™è¯¯")
    print("2. å†æ¬¡ç‚¹å‡»æç¤º'æ‚¨å·²ç»å›ç­”è¿‡è¿™é“é¢˜'")
    print("3. æ— æ³•è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€é¢˜")
    print("4. å€’è®¡æ—¶ç»“æŸåä¸ä¼šè‡ªåŠ¨å¤„ç†")
    
    print("\nğŸ”§ ä¿®å¤å†…å®¹:")
    print("1. æ”¹è¿›äº†ç­”æ¡ˆæäº¤çš„é”™è¯¯å¤„ç†é€»è¾‘")
    print("2. ä¿®å¤äº†é‡å¤æäº¤çš„APIå“åº”æ ¼å¼")
    print("3. æ·»åŠ äº†è‡ªåŠ¨æ£€æŸ¥ä¸‹ä¸€é¢˜çš„æœºåˆ¶")
    print("4. ä¼˜åŒ–äº†å€’è®¡æ—¶ç»“æŸåçš„å¤„ç†")
    print("5. æ”¹è¿›äº†ç½‘ç»œé”™è¯¯çš„ç”¨æˆ·æç¤º")
    
    print("\nğŸš€ æµ‹è¯•æ–¹æ³•:")
    print("1. ç¡®ä¿Flaskåº”ç”¨æ­£åœ¨è¿è¡Œ (python run.py)")
    print("2. æ‰“å¼€æµè§ˆå™¨è®¿é—®: http://localhost:5000")
    print("3. æ³¨å†Œ/ç™»å½•ä¸ºå¬ä¼—")
    print("4. åŠ å…¥æ´»è·ƒä¼šè¯å¹¶ç­”é¢˜")
    
    print("\nğŸ“ æ ¸å¿ƒä¿®å¤:")
    print("- submitAnswer()å‡½æ•°: æ”¹è¿›é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†")
    print("- API /api/quiz/answer: æ”¹è¿›é‡å¤ç­”é¢˜çš„å“åº”æ ¼å¼")
    print("- æ·»åŠ  checkForNextQuiz()å‡½æ•°: è‡ªåŠ¨æ£€æŸ¥æ–°é¢˜ç›®")
    print("- ä¼˜åŒ–è®¡æ—¶å™¨é€»è¾‘: æ—¶é—´åˆ°åè‡ªåŠ¨å¤„ç†")
    print("- æ™ºèƒ½æ£€æŸ¥é¢‘ç‡è°ƒæ•´: æ ¹æ®é¢˜ç›®çŠ¶æ€è°ƒæ•´æ£€æŸ¥é—´éš”")
    
    # æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
    print("\nğŸ” æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€...")
    try:
        import requests
        response = requests.get("http://localhost:5000", timeout=3)
        if response.status_code == 200:
            print("âœ… FlaskæœåŠ¡å™¨è¿è¡Œæ­£å¸¸")
            
            # æ£€æŸ¥API
            api_response = requests.get("http://localhost:5000/api/quiz/current/1", timeout=3)
            print(f"âœ… ç­”é¢˜APIè¿è¡Œæ­£å¸¸ (çŠ¶æ€ç : {api_response.status_code})")
            
            # è¯¢é—®æ˜¯å¦æ‰“å¼€æµ‹è¯•é¡µé¢
            choice = input("\næ˜¯å¦æ‰“å¼€æµ‹è¯•é¡µé¢ï¼Ÿ(y/n): ").lower().strip()
            if choice == 'y':
                print("ğŸŒ æ­£åœ¨æ‰“å¼€å¬ä¼—ç«¯ç•Œé¢...")
                webbrowser.open("http://localhost:5000")
                time.sleep(2)
                print("ğŸŒ æ­£åœ¨æ‰“å¼€æµ‹è¯•é¡µé¢...")
                webbrowser.open(f"file://{os.path.abspath('test_listener_page.html')}")
                
                print("\nğŸ“Œ æµ‹è¯•è¯´æ˜:")
                print("1. åœ¨å¬ä¼—ç«¯é¡µé¢æ³¨å†Œ/ç™»å½•")
                print("2. åŠ å…¥ä¸€ä¸ªæ´»è·ƒä¼šè¯")
                print("3. ç­”é¢˜æµ‹è¯•:")
                print("   - é€‰æ‹©ç­”æ¡ˆå¹¶æäº¤ â†’ åº”è¯¥æ­£å¸¸æäº¤")
                print("   - å†æ¬¡æäº¤ â†’ åº”è¯¥æç¤ºå·²å›ç­”å¹¶æ˜¾ç¤ºç»“æœ")
                print("   - ç­‰å¾…è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸‹ä¸€é¢˜")
                print("4. åœ¨æµ‹è¯•é¡µé¢å¯ä»¥æ¨¡æ‹Ÿå„ç§æƒ…å†µ")
                
        else:
            print("âŒ FlaskæœåŠ¡å™¨è®¿é—®å¼‚å¸¸")
            print("è¯·ç¡®ä¿è¿è¡Œ: python run.py")
            
    except Exception as e:
        print("âŒ æ— æ³•è¿æ¥åˆ°FlaskæœåŠ¡å™¨")
        print(f"é”™è¯¯: {e}")
        print("è¯·å…ˆå¯åŠ¨æœåŠ¡å™¨: python run.py")
    
    print("\nğŸ‰ ä¿®å¤å®Œæˆï¼ä¸»è¦æ”¹è¿›:")
    print("âœ… ç½‘ç»œé”™è¯¯å¤„ç†")
    print("âœ… é‡å¤æäº¤å¤„ç†")
    print("âœ… è‡ªåŠ¨åˆ‡æ¢ä¸‹ä¸€é¢˜")
    print("âœ… è®¡æ—¶å™¨ä¼˜åŒ–")
    print("âœ… ç”¨æˆ·ä½“éªŒæ”¹è¿›")

if __name__ == "__main__":
    show_demo()
